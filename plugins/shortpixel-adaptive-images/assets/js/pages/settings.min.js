(function(t){document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("chart");if(!(t instanceof HTMLElement)){return false}var a=t.parentNode;var e=14;window.statusBox.chart.cdn.data.mb=window.statusBox.chart.cdn.data.mb.length<=e?window.statusBox.chart.cdn.data.mb:window.statusBox.chart.cdn.data.mb.slice(window.statusBox.chart.cdn.data.mb.length-e);window.statusBox.chart.cdn.labels=window.statusBox.chart.cdn.labels.length<=e?window.statusBox.chart.cdn.labels:window.statusBox.chart.cdn.labels.slice(window.statusBox.chart.cdn.labels.length-e);window.statusBox.chart.credits.labels=window.statusBox.chart.credits.labels.length<=e?window.statusBox.chart.credits.labels:window.statusBox.chart.credits.labels.slice(window.statusBox.chart.credits.labels.length-e);window.statusBox.chart.credits.data.paid=window.statusBox.chart.credits.data.paid.length<=e?window.statusBox.chart.credits.data.paid:window.statusBox.chart.credits.data.paid.slice(window.statusBox.chart.credits.data.paid.length-e);if(window.statusBox.chart.cdn.data.mb.length!==window.statusBox.chart.credits.data.paid.length){var n=window.statusBox.chart.cdn.data.mb.length>window.statusBox.chart.credits.data.paid.length?window.statusBox.chart.cdn.data.mb.length-window.statusBox.chart.credits.data.paid.length:window.statusBox.chart.credits.data.paid.length-window.statusBox.chart.cdn.data.mb.length,s=new Array(n).fill(0);if(window.statusBox.chart.cdn.data.mb.length>window.statusBox.chart.credits.data.paid.length){window.statusBox.chart.credits.data.paid=s.concat(window.statusBox.chart.credits.data.paid)}else{window.statusBox.chart.cdn.data.mb=s.concat(window.statusBox.chart.cdn.data.mb)}}var i=window.statusBox.chart.cdn.labels.length>=window.statusBox.chart.credits.labels.length?window.statusBox.chart.cdn.labels:window.statusBox.chart.credits.labels,o=window.statusBox.chart.cdn.data.mb,d=window.statusBox.chart.credits.data.paid;if(!a.classList.contains("expanded")){i=i.slice(i.length/2);o=o.slice(o.length/2);d=d.slice(d.length/2)}window.statusBox.chart.instance=new Chart(document.getElementById("chart").getContext("2d"),{type:"line",data:{labels:i,datasets:[{label:window.statusBox.chart.titles.cdn,borderColor:window.statusBox.chart.colors.cdn,backgroundColor:window.statusBox.chart.backgrounds.cdn,fill:true,pointHitRadius:10,data:o,yAxisID:"cdn"},{label:window.statusBox.chart.titles.credits,borderColor:window.statusBox.chart.colors.credits,backgroundColor:window.statusBox.chart.backgrounds.credits,fill:true,pointHitRadius:10,data:d,yAxisID:"credits"}]},options:{responsive:true,hoverMode:"index",stacked:false,legend:{position:"top",labels:{boxWidth:20,usePointStyle:true}},scales:{yAxes:[{type:"linear",display:true,position:"left",id:"cdn"},{type:"linear",display:true,position:"right",id:"credits",gridLines:{drawOnChartArea:false}}]}}})}));var a={},e={};a.noticesQtyAtOneMoment=3;a.previousNotices=[];a.parseTab=function(t){if(t.indexOf("#top")===0){t=t.replace("#top","")}return t.indexOf("#")===0?t:false};a.prepareValue=function(t){var a=t.data("type"),e=t.prop("tagName").toLowerCase();switch(a){case"string":return e==="input"||e==="textarea"?t.val():undefined;case"int":return e==="input"?parseInt(t.val(),10):e==="textarea"?parseInt(t.text(),10):undefined;case"bool":return t.prop("checked");default:return undefined}};a.showNotice=function(a){if(typeof a!=="string"||a===""){return}var e=t("#wpbody .wrap h1"),n=t(".notice"),s=t(a).hide();if(n.length>0){n.last().after(s)}else{e.after(s)}this.previousNotices.push(s);if(this.previousNotices.length>this.noticesQtyAtOneMoment){for(var i=0;i<this.previousNotices.length-this.noticesQtyAtOneMoment;i++){var o=this.previousNotices[i];if(o===s)continue;o.slideUp("fast",(function(){o.remove()}));this.previousNotices.splice(i,1)}}t(document).trigger("wp-updates-notice-added");s.slideDown("fast",(function(){s.removeAttr("style");t("html:not(:animated), body:not(:animated)").animate({scrollTop:e.offset().top},500)}));setTimeout((function(){s.slideUp("fast",(function(){s.remove()}))}),2e4)};a.save=function(e){e.preventDefault();var n=t(this),s=n.find(".spai_settings_tab"),i=n.find('[type="submit"]');var o={};var d={url:n.attr("action"),method:n.attr("method")};var r={text:{default:i.val(),saving:i.data("saving-text")}};d.url=!d.url?"/wp-admin/admin-ajax.php":d.url;d.method=!d.method?"post":d.method;r.text.default=!r.text.default?"Save Changes":r.text.default;r.text.saving=!r.text.saving?"Saving...":r.text.saving;s.each((function(){var e=t(this),n=e.find("[name]");var s=e.attr("id");if(s){o[s]={}}n.each((function(){var e=t(this);var n=e.attr("type"),i=e.attr("name"),d=e.prop("checked");if(n==="radio"){if(d){o[s][i]=a.prepareValue(e)}}else{o[s][i]=a.prepareValue(e)}}))}));t.ajax({url:d.url,method:d.method,dataType:"json",data:{action:"shortpixel_ai_handle_page_action",page:"settings",data:{action:"save",options:JSON.stringify(o)}},beforeSend:function(){if(r.text.saving){i.prop("disabled",true);i.val(r.text.saving)}},success:function(e){if(typeof e.notice==="string"&&e.notice!==""){a.showNotice(e.notice);if(t('div.notice[data-causer="twicelossy"]').length&&!t("input#lossy").is(":checked")){t('div.notice[data-causer="twicelossy"]').remove()}}},complete:function(){if(r.text.default){i.prop("disabled",false);i.val(r.text.default)}}})};a.updateChartData=function(){var t=window.statusBox.chart.instance,a=window.statusBox.chart.cdn.labels.length>=window.statusBox.chart.credits.labels.length?window.statusBox.chart.cdn.labels:window.statusBox.chart.credits.labels,e=window.statusBox.chart.cdn.data.mb,n=window.statusBox.chart.credits.data.paid;if(!t.canvas.parentNode.classList.contains("expanded")){a=a.slice(a.length/2);e=e.slice(e.length/2);n=n.slice(n.length/2)}t.data.labels=a;t.data.datasets=[{label:window.statusBox.chart.titles.cdn,borderColor:window.statusBox.chart.colors.cdn,backgroundColor:window.statusBox.chart.backgrounds.cdn,fill:true,pointHitRadius:10,data:e,yAxisID:"cdn"},{label:window.statusBox.chart.titles.credits,borderColor:window.statusBox.chart.colors.credits,backgroundColor:window.statusBox.chart.backgrounds.credits,fill:true,pointHitRadius:10,data:n,yAxisID:"credits"}]};e.validateSelector=function(t){try{document.querySelector(t);return true}catch(t){return false}};e.prepare=function(){var a=t('[ data-setting="exclusion"]');a.each((function(){var a=t(this),e=a.data("texts"),n=a.val();if(typeof e!=="object"){e={add:"Add",save:"Save"}}var s=a.data("separator"),i=a.data("exclusion-type");s=typeof s==="string"&&s!==""?s:",";i=typeof i==="string"&&i!==""?i:"selectors";var o=typeof n==="string"&&n!==""?n.split(typeof s==="string"&&s!==""?s:","):[],d="";for(var r=0,c=o[r];r<o.length;c=o[++r]){d+='<div data-index="'+r+'" data-action="edit"><span class="selector">'+c+'</span><span data-action="delete"></span></div>'}var l=t('<div class="exclusion-wrap" data-type="'+i+'">'+'<div class="exclusions-content clearfix" data-action="add"><div class="plus"></div>'+d+"</div>"+'<div class="buttons-wrap hidden">'+'<div class="error-message hidden"></div>'+(i==="urls"?'<select><option value="path">Path</option><option value="regex">RegEx</option><option value="http">HTTP</option><option value="https">HTTPS</option></select> : ':"")+'<input type="text"><button type="button" class="dark_blue_link" data-action="confirm" data-texts='+JSON.stringify(e)+">"+e.add+"</button></div></div>");a.before(l);l.append(a)}))};e.updateRealField=function(a,e){var n=[],s=a.data("separator");s=typeof s==="string"&&s!==""?s:",";if(e.length>0){e.each((function(){n.push(t(this).text())}))}a.val(n.join(s))};e.updateWarningMessage=function(t,a){var e=parseInt(t.data("limit"),10);t.find("span").text(a);if(a>e){t.slideDown("fast")}else{t.slideUp("fast")}};e.inputActionsHandler=function(a){var e=t(this),n=e.siblings("select"),s=n.find("option"),i=e.siblings("button");if(a.type==="keypress"){var o=["Enter"];if(o.includes(a.key)){a.preventDefault();a.stopPropagation();i.click()}}else if("input"||"focus"||"blur"||"change"){if(n.length===0){return}var d=e.val(),r=[];if(s.length>0){s.each((function(){r.push(t(this).val())}))}r.forEach((function(t){if(d.indexOf(t+":")===0){e.val(d.replace(t+":",""));n.val(t)}}))}};e.actionsHandler=function(a){a.preventDefault();a.stopPropagation();var n=t(this),s=n.parents("td"),i=s.find("p.warning"),o=n.parents(".exclusion-wrap"),d=o.find("textarea"),r=o.find(".buttons-wrap"),c=r.find(".error-message"),l=r.find("input"),p=r.find("select"),u=r.find("button"),f=o.find(".exclusions-content"),h=f.find(".selector"),v=f.find("div[data-index]");var w=l.val(),g=u.attr("data-texts"),x=n.attr("data-action"),b=n.attr("data-state");var m=d.data("exclusion-type");w=typeof w==="string"&&w!==""?w.trim():"";x=typeof x==="string"&&x!==""?x:undefined;b=x==="confirm"&&typeof b==="string"&&b!==""?b:"add";m=typeof m==="string"&&m!==""?m:"selectors";try{g=JSON.parse(g)}catch(t){g={add:"Add",save:"Save"}}switch(x){case"add":u.text(g.add).attr("data-state","add").removeAttr("data-editing");l.removeClass("error").val("");r.slideDown("fast");c.text("").slideUp("fast");l.focus();break;case"edit":var y=n.find(".selector");l.removeClass("error").val(y.text());u.text(g.save).attr("data-state","save").attr("data-editing",n.attr("data-index"));r.slideDown("fast");c.text("").slideUp("fast");l.focus();break;case"delete":n.parents("div[data-index]").fadeOut("fast",(function(){t(this).remove();e.updateWarningMessage(i,s.find(".selector").length);e.updateRealField(d,f.find(".selector"))}));u.removeAttr("data-editing").removeAttr("data-state");r.slideUp("fast");l.removeClass("error").val("");c.text("").slideUp("fast");break;case"confirm":var B=p.val(),C=false,k=m==="urls"?B+":"+w:w,_=m==="urls"?[k]:k.split(",");_=_.map((function(t){return typeof t==="string"?t.trim():t}));if(m==="selectors"&&!e.validateSelector(w)){l.addClass("error");c.html(window.exclusionsL10n.messages.selectors.invalid).slideDown("fast");break}for(var A=0,y=t(h[A]);A<h.length;y=t(h[++A])){var D=y.text();_=_.filter((function(t){return b==="save"&&y.parent().attr("data-index")===n.attr("data-editing")&&D===t||D!==t}));if(_.length<=0){C=true;l.addClass("error");c.html(window.exclusionsL10n.messages.selectors.alreadyExists).slideDown("fast");break}}if(!!C){break}var N=function(a,e){var n=t('<div data-index="'+(S+e)+'" data-action="edit" class="hidden"><span class="selector">'+a+'</span><span data-action="delete"></span></div>');f.append(n);n.fadeIn("fast")};if(b==="add"&&w!==""&&_.length>0){var S=v.length>0?parseInt(v.last().attr("data-index"),10)+1:0;_.map(N)}else if(b==="save"&&w!==""&&_.length>0){var S=n.attr("data-editing");f.find('div[data-index="'+S+'"] .selector').text(_.shift());if(_.length>0){S=v.length>0?parseInt(v.last().attr("data-index"),10)+1:0;_.map(N)}}r.slideUp("fast");l.removeClass("error").val("");c.text("").slideUp("fast");u.removeAttr("data-editing").removeAttr("data-state");break}e.updateWarningMessage(i,s.find(".selector").length);e.updateRealField(d,f.find(".selector"))};t((function(){var n=t(this);if(document.location.hash!==""){var s=t('a[href="'+document.location.hash+'"]');t("#wpspai-tabs a.nav-tab").removeClass("nav-tab-active");t(".spai_settings_tab").removeClass("active");var i=a.parseTab(s.attr("href"));if(!!i){var o=t(i);if(o.length>0){s.addClass("nav-tab-active");o.addClass("active");if(typeof window.Beacon==="function"&&typeof window.beaconConstants==="object"){var d=o.attr("id");if(typeof window.beaconConstants.suggestions[d]!=="undefined"){window.Beacon("suggest",window.beaconConstants.suggestions[d])}}}}}e.prepare();n.on("click",".exclusion-wrap [data-action]",e.actionsHandler);n.on("change focus blur input keypress",".exclusion-wrap input",e.inputActionsHandler);n.on("submit","form#settings-form",a.save);n.on("click",".chart-wrap .toggle",(function(){t(this).parent().toggleClass("expanded");a.updateChartData()}));n.on("dblclick",".chart-wrap canvas",(function(){if(window.matchMedia("(min-width : 850px)").matches){t(this).parent().toggleClass("expanded");a.updateChartData()}}));n.on("click","#wpspai-tabs a.nav-tab",(function(e){var n=t(this);t("#wpspai-tabs a.nav-tab").removeClass("nav-tab-active");t(".spai_settings_tab").removeClass("active");var s=a.parseTab(n.attr("href"));if(!!s){var i=t(s);if(i.length>0){n.addClass("nav-tab-active");i.addClass("active");var o=document.getElementsByClassName("shortpixel-offer-wso");if(o.length){o[0].style.display=s==="#compression"?"none":"block"}if(typeof window.Beacon==="function"&&typeof window.beaconConstants==="object"){var d=i.attr("id");if(typeof window.beaconConstants.suggestions[d]!=="undefined"){window.Beacon("suggest",window.beaconConstants.suggestions[d])}}}}}));n.on("change",'input[type="radio"]',(function(){var a=t(this);var e=a.val();if(typeof e==="string"&&e!==""){var n=a.parent(),s=n.siblings('p[data-explanation="'+e+'"]'),i=n.siblings("p[data-explanation]").not(s),o=n.siblings('.children-wrap[data-parent="'+e+'"]'),d=n.siblings(".children-wrap[data-parent]").not(o);i.addClass("hidden");s.removeClass("hidden");d.addClass("hidden");o.removeClass("hidden")}}));n.on("change",'input[type="checkbox"]',(function(){var a=t(this),e=a.parent("[data-depended]"),n=e.siblings("[data-depended]"),s=n.find('input[type="checkbox"]:checked'),i=a.siblings(".notification_popup");var o=a.prop("checked");if(o){if(i.length>0){i.removeClass("hidden");a.prop("checked",false)}else{a.siblings(".children-wrap").removeClass("hidden");a.siblings("[data-depended]").find('input[type="checkbox"]').prop("checked",true)}}else{a.siblings(".children-wrap").addClass("hidden");if(e.length>0){if(s.length===0){var d=e.data("depended");d=typeof d==="string"&&d!==""?d:"";var r=t('input[name="'+d+'"]');console.log(e,r);r.prop("checked",false).siblings(".children-wrap").addClass("hidden")}}}}));n.on("click",'.notification_popup input[type="button"]',(function(){var a=t(this),e=a.parent(".notification_popup"),n=e.siblings(".children-wrap"),s=e.siblings('input[type="checkbox"]');s.prop("checked",true);n.removeClass("hidden");e.addClass("hidden")}));n.on("click",".box_dropdown .title",(function(){t(this).parent().toggleClass("opened")}));n.on("click",".spai_statusbox_wrap .title_wrap",(function(){if(document.body.clientWidth<=850){var a=t(this),e=a.parent(),n=e.find(".box_content");e.toggleClass("expanded");n.slideToggle("fast")}}));n.on("click","#clear_css_cache",(function(e){var n=t(this);var s={default:n.text(),onPress:n.attr("data-pressed-text")};t.ajax({method:"post",url:"/wp-admin/admin-ajax.php",data:{action:"shortpixel_ai_handle_page_action",page:"settings",data:{action:"clear css cache"}},beforeSend:function(){n.addClass("button");n.text(s.onPress);n.prop("disabled",true)},success:function(t){if(typeof t.notice==="string"&&t.notice!==""){a.showNotice(t.notice)}},complete:function(){n.text(s.default)}})}));n.on("submit","form#api-key-form",(function(e){e.preventDefault();var n=t(this),s=n.find('[name]:not([type="hidden"])'),i=n.find('[type="submit"]');var o={url:n.attr("action"),method:n.attr("method")};var d={text:{default:i.val(),saving:i.data("saving-text")}};var r=false;s.each((function(){var a=t(this),e=a.val();if(typeof e==="string"&&e!==""){r=true}}));if(!r){return}o.url=!o.url?"/wp-admin/admin-ajax.php":o.url;o.method=!o.method?"post":o.method;d.text.default=!d.text.default?"Save":d.text.default;d.text.saving=!d.text.saving?"Saving...":d.text.saving;t.ajax({method:o.method,url:o.url,data:n.serialize(),beforeSend:function(){i.text(d.text.saving);i.prop("disabled",true)},success:function(t){if(t.success){if(t.reload){document.location.reload()}}else if(t.notice){a.showNotice(t.notice)}},complete:function(){i.text(d.text.default);i.prop("disabled",false)}})}));n.on("click",".spai_statusbox_wrap [data-action], .spai_settings_tab [data-action]",(function(e){e.preventDefault();var n=t(this);var s=n.attr("data-action"),i=n.prop("tagName").toLowerCase();s=typeof s==="string"||s!==""?s:undefined;t.ajax({method:"post",url:"/wp-admin/admin-ajax.php",data:{action:"shortpixel_ai_handle_page_action",page:"settings",data:{action:s}},beforeSend:function(){if(i==="button"||i==="input"){n.prop("disabled",true)}},success:function(t){if(t.success){if(t.reload){document.location.reload()}}if(t.notice){a.showNotice(t.notice)}},complete:function(){if(i==="button"||i==="input"){n.prop("disabled",false)}}})}))}))})(jQuery);